(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{308:function(e,t,a){"use strict";a.r(t);var o=a(13),r=Object(o.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"indexing-with-blacklab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#indexing-with-blacklab"}},[e._v("#")]),e._v(" Indexing with BlackLab")]),e._v(" "),t("h2",{attrs:{id:"indextool"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#indextool"}},[e._v("#")]),e._v(" IndexTool")]),e._v(" "),t("p",[e._v("IndexTool is a simple commandline application to create a corpus and add documents to it.")]),e._v(" "),t("p",[e._v("Get the blacklab JAR and the required libraries (see "),t("RouterLink",{attrs:{to:"/guide/getting-started.html#getting-blacklab"}},[e._v("Getting started")]),e._v('). The libraries should be in a directory called "lib" that\'s in the same directory as the BlackLab JAR (or elsewhere on the classpath).')],1),e._v(" "),t("p",[e._v("Start the IndexTool without parameters for help information:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('java -cp "blacklab.jar:lib" nl.inl.blacklab.tools.IndexTool\n')])])]),t("p",[e._v("(this assumes "),t("code",[e._v("blacklab.jar")]),e._v(" and the "),t("code",[e._v("lib")]),e._v(" subdirectory containing required libraries are located in the current directory)")]),e._v(" "),t("p",[e._v("(if you're on Windows, replace the classpath separator colon "),t("code",[e._v(":")]),e._v(" with a semicolon "),t("code",[e._v(";")]),e._v(")")]),e._v(" "),t("p",[e._v("To create a new index:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('java -cp "blacklab.jar:lib" nl.inl.blacklab.tools.IndexTool create INDEX_DIR INPUT_FILES FORMAT\n')])])]),t("p",[e._v("To add documents to an existing index:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('java -cp "blacklab.jar:lib" nl.inl.blacklab.tools.IndexTool add INDEX_DIR INPUT_FILES FORMAT\n')])])]),t("p",[e._v("If you specify a directory as the "),t("code",[e._v("INPUT_FILES")]),e._v(", it will be scanned recursively. You can also specify a file glob (such as "),t("code",[e._v("*.xml")]),e._v("; single-quote it if you're on Linux so it doesn't get expanded by the shell) or a single file. If you specify a "),t("code",[e._v(".zip")]),e._v(" or "),t("code",[e._v(".tar.gz")]),e._v(" file, BlackLab will automatically index the contents.")]),e._v(" "),t("p",[e._v("For example, if you have TEI data in "),t("code",[e._v("/data/input/my-tei-files")]),e._v(" and want to index your corpus to "),t("code",[e._v("/data/blacklab-corpora/my-corpus")]),e._v(", run the following command:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('java -cp "blacklab.jar:lib" nl.inl.blacklab.tools.IndexTool create /data/blacklab-corpora/my-corpus /data/input/my-tei-files tei\n')])])]),t("p",[e._v("Your data is indexed and placed in a new BlackLab index in the "),t("code",[e._v("/data/blacklab-corpora/my-corpus")]),e._v(" directory.")]),e._v(" "),t("p",[e._v("If you don't specify a glob, IndexTool will index "),t("code",[e._v("*.xml")]),e._v(" by default. You can specify a glob (like "),t("code",[e._v("*.txt")]),e._v(" or "),t("code",[e._v("*")]),e._v(" for all files) to change this.")]),e._v(" "),t("p",[e._v("Also, please note that if you're indexing large files, you should "),t("a",{attrs:{href:"https://docs.oracle.com/cd/E15523_01/web.1111/e13814/jvm_tuning.htm#PERFM161",target:"_blank",rel:"noopener noreferrer"}},[e._v("give java more than the default heap memory"),t("OutboundLink")],1),e._v(", using the "),t("code",[e._v("-Xmx")]),e._v(" option. For really large files, and if you have the memory, you could use "),t("code",[e._v("-Xmx 6G")]),e._v(", for example.")]),e._v(" "),t("p",[e._v("To delete documents from an index:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('java -cp "blacklab.jar:lib" nl.inl.blacklab.tools.IndexTool delete INDEX_DIR FILTER_QUERY\n')])])]),t("p",[e._v("Here, "),t("code",[e._v("FILTER_QUERY")]),e._v(" is a metadata filter query in Lucene query language that matches the documents to delete. Deleting documents and re-adding them can be used to update documents.")]),e._v(" "),t("h2",{attrs:{id:"supported-formats"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#supported-formats"}},[e._v("#")]),e._v(" Supported formats")]),e._v(" "),t("p",[e._v("BlackLab supports a number of input formats that are common in corpus linguistics:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("tei")]),e._v(" ("),t("a",{attrs:{href:"http://www.tei-c.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Text Encoding Initiative"),t("OutboundLink")],1),e._v(", a popular XML format for linguistic resources, including corpora. indexes content inside the 'body' element; assumes part of speech is found in an attribute called 'type')")]),e._v(" "),t("li",[t("code",[e._v("sketch-wpl")]),e._v(" (the TSV/XML hybrid input "),t("a",{attrs:{href:"https://www.sketchengine.co.uk/documentation/preparing-corpus-text/",target:"_blank",rel:"noopener noreferrer"}},[e._v("format the Sketch Engine/CWB use"),t("OutboundLink")],1),e._v(")")]),e._v(" "),t("li",[t("code",[e._v("chat")]),e._v(" ("),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/CHILDES#Database_Format",target:"_blank",rel:"noopener noreferrer"}},[e._v("Codes for the Human Analysis of Transcripts"),t("OutboundLink")],1),e._v(", the format used by the CHILDES project)")]),e._v(" "),t("li",[t("code",[e._v("folia")]),e._v(" (a "),t("a",{attrs:{href:"https://proycon.github.io/folia/",target:"_blank",rel:"noopener noreferrer"}},[e._v("corpus XML format"),t("OutboundLink")],1),e._v(" popular in the Netherlands)")]),e._v(" "),t("li",[t("code",[e._v("tsv-frog")]),e._v(" (tab-separated file as produced by the "),t("a",{attrs:{href:"https://languagemachines.github.io/frog/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Frog annotation tool"),t("OutboundLink")],1),e._v(")")])]),e._v(" "),t("p",[e._v("BlackLab also supports these generic file formats:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("csv")]),e._v(' (Comma-Separated Values file that should have column names "word", "lemma" and "pos")')]),e._v(" "),t("li",[t("code",[e._v("tsv")]),e._v(' (Tab-Separated Values file that should have column names "word", "lemma" and "pos")')]),e._v(" "),t("li",[t("code",[e._v("txt")]),e._v(" (A plain text file; will tokenize on whitespace and index word forms)")])]),e._v(" "),t("p",[e._v("A number of less common formats are also supported:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("pagexml")]),e._v(" (OCR XML format)")]),e._v(" "),t("li",[t("code",[e._v("alto")]),e._v(" ("),t("a",{attrs:{href:"http://www.loc.gov/standards/alto/",target:"_blank",rel:"noopener noreferrer"}},[e._v("another OCR XML format"),t("OutboundLink")],1),e._v(")")])]),e._v(" "),t("p",[e._v("To add support for your own format, you just have to "),t("RouterLink",{attrs:{to:"/guide/how-to-configure-indexing.html"}},[e._v("write a configuration file")]),e._v(". (There's a "),t("RouterLink",{attrs:{to:"/development/customization/docindexer.html"}},[e._v("legacy way")]),e._v(" too, but that involves writing Java code and you probably don't need it) Please "),t("RouterLink",{attrs:{to:"/guide/about.html#contact-us"}},[e._v("contact us")]),e._v(" if you have any questions.")],1),e._v(" "),t("p",[e._v("If you choose the first option, specify the format name (which must match the name of the .blf.yaml or .blf.json file) as the FORMAT parameter. IndexTool will search a number of directories, including the current directory and the (parent of the) input directory for format files.")]),e._v(" "),t("p",[e._v("If you choose the second option, specify the fully-qualified class name of your DocIndexer class as the FORMAT parameter.")]),e._v(" "),t("h2",{attrs:{id:"add-your-own-format"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add-your-own-format"}},[e._v("#")]),e._v(" Add your own format")]),e._v(" "),t("p",[e._v("There's two approaches to adding support for a new input format in BlackLab. The preferred one is to write an input format configuration file in either YAML or JSON format. See "),t("RouterLink",{attrs:{to:"/guide/how-to-configure-indexing.html"}},[e._v("How to configure indexing")]),e._v(".")],1),e._v(" "),t("p",[e._v("The other way is considered somewhat legacy, although it may still be useful in rare cases. It may offer slightly better performance and complete control over the indexing process. This is documented below. You're probably better off with the configuration file approach, though.")]),e._v(" "),t("h2",{attrs:{id:"faster-indexing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#faster-indexing"}},[e._v("#")]),e._v(" Faster indexing")]),e._v(" "),t("p",[e._v("IndexTool will try to index two documents at the same time by default. If you have enough CPU cores and memory, you can increase this number by setting the "),t("code",[e._v("--threads n")]),e._v(" option, where n is the number of threads to use (i.e. documents to index at the same time).")]),e._v(" "),t("p",[e._v("If you find that IndexTool is running out of memory, or becoming very slow, try a lower number of threads instead.")]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("ul",[t("li",[e._v("multi-threaded indexing currently works per-file, so if all your documents are in a single large file, only 1 thread will be used.")]),e._v(" "),t("li",[e._v("large files appear to gradually degrade indexing performance as we get further into the file.")])]),e._v(" "),t("p",[e._v("For these reasons, it is currently better to spread your documents over multiple files, although it is not necessary to limit yourself to 1 document per file. Just make sure your files aren't larger than a few MB.")])])])}),[],!1,null,null,null);t.default=r.exports}}]);